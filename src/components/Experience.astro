---
import { getCollection } from 'astro:content';

const experiences = await getCollection('experience');
// Optional: Sort experiences by date or some other field if needed. 
// For now, assuming file creation order or name sort, but best to have a date field.
// I didn't add a date field in schema, so relying on implicit order or file name.
---

<section id="experience" class="py-20 bg-slate-50 dark:bg-slate-900/50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-3xl font-bold text-slate-900 dark:text-white sm:text-4xl">Work Experience</h2>
      <p class="mt-4 text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
        My professional journey and key contributions.
      </p>
    </div>

    <div class="relative max-w-4xl mx-auto">
      <!-- Vertical line -->
      <div class="absolute left-4 md:left-1/2 transform md:-translate-x-1/2 w-0.5 h-full bg-slate-200 dark:bg-slate-700"></div>

      <div class="space-y-12">
        {experiences.map((expEntry, index) => {
          const exp = expEntry.data;
          return (
            <div class={`relative flex flex-col md:flex-row items-start md:items-center md:justify-between w-full ${index % 2 === 0 ? 'md:flex-row-reverse' : ''}`}>
               <!-- Spacer for Desktop -->
              <div class="hidden md:block w-5/12"></div>
              
              <!-- Dot -->
              <div class="absolute left-4 md:left-1/2 transform -translate-x-1/2 w-8 h-8 rounded-full border-4 border-white dark:border-slate-800 bg-emerald-500 shadow-lg z-10 flex items-center justify-center mt-0 md:mt-0">
                  <div class="w-3 h-3 bg-white rounded-full"></div>
              </div>
              
              <!-- Content -->
              <div class="w-full md:w-5/12 pl-12 md:pl-0">
                   <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-md border border-slate-100 dark:border-slate-700 hover:shadow-lg transition-shadow relative">
                        <span class="inline-block px-3 py-1 mb-2 text-xs font-semibold tracking-wider text-emerald-600 dark:text-emerald-400 uppercase bg-emerald-50 dark:bg-emerald-900/30 rounded-full">
                          {exp.period}
                        </span>
                        <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-1">{exp.role}</h3>
                        <h4 class="text-md font-medium text-slate-600 dark:text-slate-300 mb-4">{exp.company}</h4>
                        <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed">
                          {exp.description}
                        </p>
                   </div>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </div>
</section>
